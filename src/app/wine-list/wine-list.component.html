<div class="container">
  <table class="table table-bordered table-responsive-sm table-striped table-hover text-center table-sm" style="background-color: white">
    <thead class="thead-light">
      <tr>
        <th style="width: 3%">#</th>
        <th style="width: 20%">Appellation</th>
        <th style="width: 20%">Nom du château</th>
        <th style="width: 10%">Type</th>
        <th style="width: 10%">Millésime</th>
        <th style="width: 9%">Achats</th>
        <th style="width: 9%">Stock</th>
        <th style="width: 9%">Déstockage</th>
        <th style="width: 10%">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let wine of wines; let i = index" [ngClass]="{'table-warning': wine.nbBouteillesStock === 0, '': wine.nbBouteillesStock !== 0 }">
        <td style="vertical-align:middle"> {{ i + 1 }} </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockAppelation else elseBlockAppelation"></div>
          <ng-template #thenBlockAppelation>
              <input class="form-control text-center" type="text" [(ngModel)]="wine.appellation"/>
          </ng-template>
          <ng-template #elseBlockAppelation>
              <span class="form-control-plaintext text-center">{{ wine.appellation }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockNomChateau else elseBlockNomChateau"></div>
          <ng-template #thenBlockNomChateau>
              <input class="form-control text-center" type="text" [(ngModel)]="wine.nomChateau"/>
          </ng-template>
          <ng-template #elseBlockNomChateau>
              <span class="form-control-plaintext text-center" *ngIf="!isOnEdit(wine)">{{ wine.nomChateau }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockType else elseBlockType"></div>
          <ng-template #thenBlockType>
              <input class="form-control text-center" type="text" [(ngModel)]="wine.type"/>
          </ng-template>
          <ng-template #elseBlockType>
              <span class="form-control-plaintext text-center" *ngIf="!isOnEdit(wine)">{{ wine.type }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockMillesime else elseBlockMillesime"></div>
          <ng-template #thenBlockMillesime>
              <input class="form-control text-center" type="text" [(ngModel)]="wine.millesime"/>
          </ng-template>
          <ng-template #elseBlockMillesime>
              <span class="form-control-plaintext text-center" *ngIf="!isOnEdit(wine)">{{ wine.millesime }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockNbBouteillesAchetees else elseBlockNbBouteillesAchetees"></div>
          <ng-template #thenBlockNbBouteillesAchetees>
              <input class="form-control text-center" type="number" [(ngModel)]="wine.nbBouteillesAchetees"
              (ngModelChange)="changeBouteillesAchetees(wine)" min={{wine.destockage}}/>
          </ng-template>
          <ng-template #elseBlockNbBouteillesAchetees>
              <span class="form-control-plaintext text-center" *ngIf="!isOnEdit(wine)">{{ wine.nbBouteillesAchetees }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockNbBouteillesStock else elseBlockNbBouteillesStock"></div>
          <ng-template #thenBlockNbBouteillesStock>
              <input class="form-control text-center" type="number" [(ngModel)]="wine.nbBouteillesStock"
              (ngModelChange)="changeBouteillesStock(wine)" min=0 max={{wine.nbBouteillesAchetees}}/>
          </ng-template>
          <ng-template #elseBlockNbBouteillesStock>
              <span class="form-control-plaintext text-center" *ngIf="!isOnEdit(wine)"
              [ngClass]="{'text-danger': wine.nbBouteillesStock === 0, '': wine.nbBouteillesStock !== 0 }">{{ wine.nbBouteillesStock }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockDestockage else elseBlockDestockage"></div>
          <ng-template #thenBlockDestockage>
              <input class="form-control text-center" type="number" [(ngModel)]="wine.destockage"
              (ngModelChange)="changeDestockage(wine)" min=0 max={{wine.nbBouteillesAchetees}}/>
          </ng-template>
          <ng-template #elseBlockDestockage>
              <span class="form-control-plaintext text-center" *ngIf="!isOnEdit(wine)">{{ wine.destockage }} </span>
          </ng-template>
        </td>
        <td>
          <div *ngIf="isOnEdit(wine); then thenBlockButton else elseBlockButton"></div>
          <ng-template #thenBlockButton>
            <button class="button" class="btn btn-link" style="color: Green" (click)="edit(wine)"><i class="fa fa-check" aria-hidden="true"></i></button>
          </ng-template>
          <ng-template #elseBlockButton>
            <button class="button" class="btn btn-link" style="color: Black" (click)="edit(wine)"><i class="fa fa-pencil" aria-hidden="true"></i></button>
          </ng-template>
          <button
            class="button" class="btn btn-link" style="color: Red"
            mwlConfirmationPopover
            [popoverTitle]="popoverTitle"
            [popoverMessage]="popoverMessage"
            placement="bottom"
            (confirm)="delete(wine)">
            <i class="fa fa-remove" aria-hidden="true"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
